name: Full Stack CI

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      # Backend - Using the direct path seen in your sidebar
      - name: Install server
        # We use ./server because that is where the file is relative to ci.yml
        working-directory: server 
        run: |
          if [ -f package.json ]; then
            npm install
          else
            echo "Searching for package.json..."
            find . -name "package.json"
            exit 1
          fi

      - name: Run backend tests
        working-directory: server
        run: npm test || echo "No backend tests yet"

      # Frontend
      - name: Install client
        working-directory: client
        run: npm install

      - name: Run frontend tests
        working-directory: client
        run: npm test || echo "No frontend tests yet"
